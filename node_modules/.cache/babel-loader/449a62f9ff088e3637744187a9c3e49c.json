{"ast":null,"code":"import _objectSpread from \"/Users/evan/antdAdminPro/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/evan/antdAdminPro/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/evan/antdAdminPro/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/evan/antdAdminPro/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/evan/antdAdminPro/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/evan/antdAdminPro/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/evan/antdAdminPro/src/routes/index.js\";\n\n/**\n * Created by 叶子 on 2017/8/13.\n */\nimport React, { Component } from 'react';\nimport { Route, Redirect, Switch } from 'react-router-dom';\nimport DocumentTitle from 'react-document-title';\nimport AllComponents from '../components';\nimport routesConfig from './config';\nimport queryString from 'query-string';\n\nvar CRouter =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CRouter, _Component);\n\n  function CRouter() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, CRouter);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(CRouter)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.requireAuth = function (permission, component) {\n      var auth = _this.props.auth;\n      var permissions = auth.data.permissions; // const { auth } = store.getState().httpData;\n\n      if (!permissions || !permissions.includes(permission)) return React.createElement(Redirect, {\n        to: '404',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 16\n        },\n        __self: this\n      });\n      return component;\n    };\n\n    _this.requireLogin = function (component, permission) {\n      var auth = _this.props.auth;\n      var permissions = auth.data.permissions;\n\n      if (process.env.NODE_ENV === 'production' && !permissions) {\n        // 线上环境判断是否登录\n        return React.createElement(Redirect, {\n          to: '/login',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 23\n          },\n          __self: this\n        });\n      }\n\n      return permission ? _this.requireAuth(permission, component) : component;\n    };\n\n    return _this;\n  }\n\n  _createClass(CRouter, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(Switch, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 29\n        },\n        __self: this\n      }, Object.keys(routesConfig).map(function (key) {\n        return routesConfig[key].map(function (r) {\n          var route = function route(r) {\n            var Component = AllComponents[r.component];\n            return React.createElement(Route, {\n              key: r.route || r.key,\n              exact: true,\n              path: r.route || r.key,\n              render: function render(props) {\n                var reg = /\\?\\S*/g; // 匹配?及其以后字符串\n\n                var queryParams = window.location.hash.match(reg); // 去除?的参数\n\n                var params = props.match.params;\n                Object.keys(params).forEach(function (key) {\n                  params[key] = params[key] && params[key].replace(reg, '');\n                });\n                props.match.params = _objectSpread({}, params);\n\n                var merge = _objectSpread({}, props, {\n                  query: queryParams ? queryString.parse(queryParams[0]) : {}\n                }); // 重新包装组件\n\n\n                var wrappedComponent = React.createElement(DocumentTitle, {\n                  title: r.title,\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 53\n                  },\n                  __self: this\n                }, React.createElement(Component, Object.assign({}, merge, {\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 54\n                  },\n                  __self: this\n                })));\n                return r.login ? wrappedComponent : _this2.requireLogin(wrappedComponent, r.auth);\n              },\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 36\n              },\n              __self: this\n            });\n          };\n\n          return r.component ? route(r) : r.subs.map(function (r) {\n            return route(r);\n          });\n        });\n      }), React.createElement(Route, {\n        render: function render() {\n          return React.createElement(Redirect, {\n            to: \"/404\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 69\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return CRouter;\n}(Component);\n\nexport { CRouter as default };","map":{"version":3,"sources":["/Users/evan/antdAdminPro/src/routes/index.js"],"names":["React","Component","Route","Redirect","Switch","DocumentTitle","AllComponents","routesConfig","queryString","CRouter","requireAuth","permission","component","auth","props","permissions","data","includes","requireLogin","process","env","NODE_ENV","Object","keys","map","key","r","route","reg","queryParams","window","location","hash","match","params","forEach","replace","merge","query","parse","wrappedComponent","title","login","subs"],"mappings":"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","sourcesContent":["/**\n * Created by 叶子 on 2017/8/13.\n */\nimport React, { Component } from 'react';\nimport { Route, Redirect, Switch } from 'react-router-dom';\nimport DocumentTitle from 'react-document-title';\nimport AllComponents from '../components';\nimport routesConfig from './config';\nimport queryString from 'query-string';\n\nexport default class CRouter extends Component {\n    requireAuth = (permission, component) => {\n        const { auth } = this.props;\n        const { permissions } = auth.data;\n        // const { auth } = store.getState().httpData;\n        if (!permissions || !permissions.includes(permission)) return <Redirect to={'404'} />;\n        return component;\n    };\n    requireLogin = (component, permission) => {\n        const { auth } = this.props;\n        const { permissions } = auth.data;\n        if (process.env.NODE_ENV === 'production' && !permissions) { // 线上环境判断是否登录\n            return <Redirect to={'/login'} />;\n        }\n        return permission ? this.requireAuth(permission, component) : component;\n    };\n    render() {\n        return (\n            <Switch>\n                {\n                    Object.keys(routesConfig).map(key =>\n                        routesConfig[key].map(r => {\n                            const route = r => {\n                                const Component = AllComponents[r.component];\n                                return (\n                                    <Route\n                                        key={r.route || r.key}\n                                        exact\n                                        path={r.route || r.key}\n                                        render={props => {\n                                            const reg = /\\?\\S*/g;\n                                            // 匹配?及其以后字符串\n                                            const queryParams = window.location.hash.match(reg);\n                                            // 去除?的参数\n                                            const { params } = props.match;\n                                            Object.keys(params).forEach(key => {\n                                                params[key] = params[key] && params[key].replace(reg, '');\n                                            });\n                                            props.match.params = { ...params };\n                                            const merge = { ...props, query: queryParams ? queryString.parse(queryParams[0]) : {} };\n                                            // 重新包装组件\n                                            const wrappedComponent = (\n                                                <DocumentTitle title={r.title}>\n                                                    <Component {...merge} />\n                                                </DocumentTitle>\n                                            )\n                                            return r.login\n                                                ? wrappedComponent\n                                                : this.requireLogin(wrappedComponent, r.auth)\n                                        }}\n                                    />\n                                )\n                            }\n                            return r.component ? route(r) : r.subs.map(r => route(r));\n                        })\n                    )\n                }\n\n                <Route render={() => <Redirect to=\"/404\" />} />\n            </Switch>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}